# Sử dụng đa ngôn ngữ trong Spring

[TOC]

## **1. Hướng dẫn cách làm đa ngôn ngữ**

Bây giờ chúng ta sẽ đi từng bước để làm một ứng dụng đa ngôn ngữ trong Spring. Ở bài này mình sẽ làm cho tiếng Anh và tiếng Việt . Nào bắt đầu thôi .

#### Bước 1 : Thêm dependency spring boot vào file pom.xml

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-thymeleaf</artifactId>
    <version>1.5.2.RELEASE</version>
</dependency>
```

####  Bước 2 Cấu hình LocaleResolver

Cấu hình file LocaleResolver để ứng dụng có thể biết được **locale** (tiếng Mỹ , tiếng Việt hay tiếng Pháp) mà ứng dụng đang sử dụng là gì ? .

```java
@Bean
public LocaleResolver localeResolver() {
    SessionLocaleResolver slr = new SessionLocaleResolver();
    slr.setDefaultLocale(Locale.US);
    return slr;
}
```

**LocaleResolver** interface có khả năng xát định được ngôn ngữ nào đang sử dụng bởi vì nó có cài đặt chức năng xát định locale dựa trên session , cookie , **Accept-Language** , hoặc những giá trị mình thêm trên header của request.

Trong ví dụ của chúng ta mình sẽ sử dụng Session để chuyển đổi qua lại các ngôn ngữ .

#### Bước 3 cấu hình LocaleChangeInterceptor

Tiếp theo , chúng ta cần thêm một Interceptor có nhiệm vụ chuyển đổi qua lại giữa các locale mới khi giá trị thay đổi.

```java
@Bean
public LocaleChangeInterceptor localeChangeInterceptor() {
    LocaleChangeInterceptor lci = new LocaleChangeInterceptor();
    lci.setParamName("lang");
    return lci;
}
```

**Trong file configure** **@Configuration** **class chúng ta implement the** **WebMvcConfigurer** interface và override the addInterceptors() method:

```java
@Override
public void addInterceptors(InterceptorRegistry registry) {
    registry.addInterceptor(localeChangeInterceptor());
}
```

#### Bước 4 Định nghĩa nội dung locale trong file Message Sources

Mặc định , Spring Boot sẽ tìm kiếm các file messageresource trong thư mục /src/main/resources. File locale mặc định là message.properties . Các nước khác nhau thì có định dang file khác nhau message_XX.properties. XX là locale code của mỗi nước. Ví dụ tiếng Anh thì sẽ là message_en.properties , tiếng Việt sẽ là message_vi.properties.

Sau đây là ví dụ file locale tiếng Anh messages.properties:

greeting=Hello! Welcome to our website! lang.change=Change the language lang.eng=English lang.vi=VietNam

Tiếp chúng ta sẽ tạo file locale tiếng Việt message_vi.properties có key giống như file message ở trên .

greeting= Xin Chào ! Chào mừng bạn đến với website lang.change= Thay đổi ngôn ngữ lang.eng=Tiếng Anh lang.vi =Tiếng Việt



#### Bước 5 Tạo Controller và trang HTML

Chúng ta sẽ tạo controller sẽ mapping với request của người dung là /international .

```java
@Controller
public class PageController {

    @GetMapping("/international")
    public String getInternationalPage() {
        return "international";
    }
}
```

Chúng ta sẽ sử dụng thymeleaf để hiển thị kết quả trên trang HTML .

```html
<h1 th:text="#{greeting}"></h1>
```

Nếu ta muốn thực hiện đổi ngôn ngữ tiếng Anh sang tiếng Việt thì chỉ cần thêm tham số lang=vi trên URL trong forrm /international?lang=vi Nếu ta muốn thực hiện đổi ngôn ngữ tiếng Việt sang tiếng Anh thì chỉ cần thêm tham số lang=en trên URL trong forrm /international?lang=en
Nếu không có tham số lang trên URL thì ứng dụng sẽ lấy locale mặc định trong trường hợp này sẽ lấy giá trị trong file message.properties.

Đây là đoạn mã themeleaf để cho người dùng chọn ngôn ngữ. Chúng ta sẽ truyền giá trị người dùng chọn là en hay vi lên cho controller từ đó ta thay đổi ngôn ngữ .

```html
<span th:text="#{lang.change}"></span>:
<select id="locales">
    <option value=""></option>
    <option value="en" th:text="#{lang.eng}"></option>
    <option value="vi " th:text="#{lang.fr}"></option>
</select>
```

#### Bước 6 Running the Application